# pm ‚Äî Minimal Password Manager (Rust, CLI)

**pm** ‚Äî –∫—Ä–æ—Å—Å–ø–ª–∞—Ç—Ñ–æ—Ä–º–µ–Ω–Ω—ã–π –º–∏–Ω–∏–º–∞–ª–∏—Å—Ç–∏—á–Ω—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä –ø–∞—Ä–æ–ª–µ–π –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö.  
–°–æ–∑–¥–∞–≤–∞–ª—Å—è –∫–∞–∫ —É–¥–æ–±–Ω–∞—è –∏ –∑–∞—â–∏—â—ë–Ω–Ω–∞—è –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ `pass` —Å –Ω–æ—Ä–º–∞–ª—å–Ω–æ–π –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –±—ç–∫–∞–ø–æ–≤, OTP –∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ø–∞—Ä–æ–ª–µ–π.

## üîê –û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã
- –í—Å–µ –∑–∞–ø–∏—Å–∏ —Ö—Ä–∞–Ω—è—Ç—Å—è **–ª–æ–∫–∞–ª—å–Ω–æ**, –≤ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö —Ñ–∞–π–ª–∞—Ö
- –§–∞–π–ª—ã –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω—ã **XChaCha20-Poly1305**
- –®–∏—Ñ—Ä–æ–≤–∞–ª—å–Ω—ã–π –∫–ª—é—á (Master Key, MK) —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ `config.json` –≤ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–æ–º –≤–∏–¥–µ, –¥–µ—Ä–∏–≤–∏—Ä—É–µ—Ç—Å—è —á–µ—Ä–µ–∑ **Argon2id**
- MK **–∫—ç—à–∏—Ä—É–µ—Ç—Å—è –Ω–∞ 5 –º–∏–Ω—É—Ç**, —á—Ç–æ–±—ã –Ω–µ –≤–≤–æ–¥–∏—Ç—å –º–∞—Å—Ç–µ—Ä-–ø–∞—Ä–æ–ª—å –ø—Ä–∏ –∫–∞–∂–¥–æ–º –¥–µ–π—Å—Ç–≤–∏–∏
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç OTP/TOTP –ø–æ–ª–µ (–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –≥–æ—Ç–æ–≤–∞, –º–æ–∂–Ω–æ —Ä–∞—Å—à–∏—Ä—è—Ç—å)
- –£–º–µ–µ—Ç **–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∏ –∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –ø–∞—Ä–æ–ª–∏ –≤ X11/Mac/Win/Wayland clipboard**
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ ‚Äú–ø–∞–ø–∫–∞–º‚Äù: `work/github`, `personal/email`, `crypto/binance` –∏ —Ç.–¥.
- –£–º–µ–µ—Ç –≤—ã–≤–æ–¥–∏—Ç—å —Å–ø–∏—Å–æ–∫ –∑–∞–ø–∏—Å–µ–π –ø–æ –¥–µ—Ä–µ–≤—É, –ø–æ—Ö–æ–∂–æ –Ω–∞ `pass ls` (`pm ls`)

## üöÄ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ —Å–±–æ—Ä–∫–∞

```bash
# –°–∫–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å –∏ —Å–æ–±—Ä–∞—Ç—å
git clone https://github.com/Avdushin/pm
cd pm
cargo build --release

# –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –±–∏–Ω–∞—Ä—å –≤ —Ä–∞–±–æ—á—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –∏–ª–∏ –≤ PATH
cp target/release/pm /usr/local/bin/pm
````

*(–ù–∞ Linux —Ç—Ä–µ–±—É–µ—Ç—Å—è —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–π `xclip` –∏–ª–∏ `wl-copy` –¥–ª—è clipboard-–ø–æ–¥–¥–µ—Ä–∂–∫–∏)*

```bash
sudo pacman -S xclip  # X11 (–Ω–∞–ø—Ä–∏–º–µ—Ä, Arch)
# –∏–ª–∏
sudo pacman -S wl-clipboard  # Wayland
```

---

## üß∞ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### 1. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ö—Ä–∞–Ω–∏–ª–∏—â–∞

```bash
pm init
```

–ë—É–¥–µ—Ç –¥–∏–∞–ª–æ–≥:

```
New master password: *********
Confirm master password: *********
Initialized store at /home/<user>/.local/share/pm-store
```

–°–æ–∑–¥–∞—ë—Ç—Å—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞:

```text
~/.local/share/pm-store/
‚îú‚îÄ‚îÄ config.json       # –ø–∞—Ä–∞–º–µ—Ç—Ä—ã KDF + –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–π MK
‚îî‚îÄ‚îÄ store/            # —Ç—É—Ç –ª–µ–∂–∞—Ç –∑–∞–ø–∏—Å–∏ <path>.enc
```

---

### 2. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∑–∞–ø–∏—Å–∏

```bash
pm add work/github
```

–î–∏–∞–ª–æ–≥:

```text
Master password: *********  # (–Ω–µ —Å–ø—Ä–∞—à–∏–≤–∞–µ—Ç—Å—è, –µ—Å–ª–∏ —É–∂–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω)
Username (optional): user@mail.com
Password (leave empty to generate): <empty>
URL (optional): https://github.com
Notes: My GitHub password
Saved entry work/github
```

–ï—Å–ª–∏ –ø–∞—Ä–æ–ª—å –ø—É—Å—Ç–æ–π ‚Äî –±—É–¥–µ—Ç —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.

---

### 3. –ü—Ä–æ—Å–º–æ—Ç—Ä –∑–∞–ø–∏—Å–∏

```bash
pm show work/github
```

```text
Master password:         # (–Ω–µ —Å–ø—Ä–∞—à–∏–≤–∞–µ—Ç—Å—è, –µ—Å–ª–∏ –∫—ç—à –≤–∞–ª–∏–¥–µ–Ω)
Title:    work/github
Username: user@mail.com
Password: <password>
URL:      https://github.com
Notes:    My GitHub password
Created:  2025-11-28T17-13-31Z
Updated:  2025-11-28T17-13-31Z
```

–î–æ–ø. –≤—ã–≤–æ–¥—ã:

```bash
pm show work/github --password-only
pm show work/github --json
```

---

### 4. –°–ø–∏—Å–æ–∫ –∑–∞–ø–∏—Å–µ–π (`pm ls`)

–ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ –∑–∞–ø–∏—Å–∏:

```bash
pm ls
```

–ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞:

```text
work/github
work/gitlab
personal/email
crypto/binance
```

–ü–æ–∫–∞–∑–∞—Ç—å –∑–∞–ø–∏—Å–∏ —Ç–æ–ª—å–∫–æ –ø–æ–¥ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã–º ‚Äú–∫–∞—Ç–∞–ª–æ–≥–æ–º‚Äù:

```bash
pm ls work
```

–í—ã–≤–æ–¥, –Ω–∞–ø—Ä–∏–º–µ—Ä:

```text
work/github
work/gitlab
work/jira
```

–ö–æ–º–∞–Ω–¥–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ `pass ls`, –æ–ø–∏—Ä–∞—è—Å—å –Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—É –≤–Ω—É—Ç—Ä–∏ `~/.local/share/pm-store/store`.

---

### 5. –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞

```bash
pm clip work/github
pm clip work/github --field username
```

–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ –Ω–∞ X11 (Arch Linux):

```bash
xclip -o
```

> –í–∞–∂–Ω–æ: –∫–æ–º–∞–Ω–¥–∞ `pm clip` —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –≤ GUI-—Å–µ—Å—Å–∏–∏. –í `tty` (–≥–æ–ª–æ–π –∫–æ–Ω—Å–æ–ª–∏) –≥–ª–æ–±–∞–ª—å–Ω–æ–≥–æ –∫–ª–∏–ø–±–æ—Ä–¥–∞ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç.

---

### 6. –ë—ç–∫–∞–ø –ø–∞—Ä–æ–ª–µ–π

–ë—ç–∫–∞–ø –∞—Ä—Ö–∏–≤–∏—Ä—É–µ—Ç –≤—Å—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é `pm-store`, –≤ –∫–æ—Ç–æ—Ä–æ–π –ª–µ–∂–∞—Ç **—É–∂–µ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–ø–∏—Å–∏**, —Ç–∞–∫ —á—Ç–æ –±–µ–∑ –º–∞—Å—Ç–µ—Ä-–ø–∞—Ä–æ–ª—è –∏—Ö –Ω–µ –≤—Å–∫—Ä–æ—é—Ç.

```bash
pm backup create
# –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é —Å–æ–∑–¥–∞—Å—Ç:
# backup_<timestamp>.zip   (–¥–µ—Ñ–æ–ª—Ç: ZIP)
```

–°–≤–æ—ë –∏–º—è —Ñ–∞–π–ª–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):

```bash
pm backup create my_backup        # backup_my_backup_<timestamp>.zip
pm backup create my_backup.zip    # my_backup.zip
pm backup create my_backup.tar.gz # tar.gz —Ñ–æ—Ä–º–∞—Ç
```

---

### 7. –û—á–∏—Å—Ç–∫–∞ –∫—ç—à–∞ –º–∞—Å—Ç–µ—Ä-–∫–ª—é—á–∞ (lock)

```bash
pm backup lock
# –∏–ª–∏ –µ—Å–ª–∏ –≤—ã —Å–¥–µ–ª–∞–µ—Ç–µ –æ—Ç–¥–µ–ª—å–Ω—É—é –∫–æ–º–∞–Ω–¥—É lock:
pm lock
```

–£–¥–∞–ª—è–µ—Ç –∫—ç—à-—Ñ–∞–π–ª —Å–µ—Å—Å–∏–∏, —á—Ç–æ–±—ã MK –Ω–µ –ª–µ–∂–∞–ª –≤–æ –≤—Ä–µ–º–µ–Ω–Ω–æ–º storage.

---

### 8. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –Ω–æ–≤–æ–≥–æ –ø–∞—Ä–æ–ª—è –±–µ–∑ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è

–ü–æ–∫–∞ –º–æ–∂–Ω–æ –≤—ã–∑–≤–∞—Ç—å –∏–∑ Rust REPL –∏–ª–∏ –¥–æ–±–∞–≤–∏—Ç—å –æ—Ç–¥–µ–ª—å–Ω—É—é CLI-–∫–æ–º–∞–Ω–¥—É.
–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ –¥–ª—è –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å —Ç–∞–∫:

```bash
pm show work/github --password-only | xclip -selection clipboard
```

---

## ‚ö†Ô∏è Security Note

–ö—ç—à –º–∞—Å—Ç–µ—Ä-–∫–ª—é—á–∞ (`pm-session.json`) —Ö—Ä–∞–Ω–∏—Ç—Å—è –ø–æ –ø—É—Ç–∏:

* –ù–∞ Linux: `$XDG_RUNTIME_DIR/pm-session.json` *(–æ–±—ã—á–Ω–æ `/run/user/1000/pm-session.json`)*
* –ü—Ä–∞–≤–∞ —Ñ–∞–π–ª–∞: `600`

–ö—ç—à —Å–æ–¥–µ—Ä–∂–∏—Ç **Master Key –≤ Base64** –Ω–∞ 5 –º–∏–Ω—É—Ç ‚Äî —ç—Ç–æ trade-off –º–µ–∂–¥—É –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å—é –∏ —É–¥–æ–±—Å—Ç–≤–æ–º.

---

## üì¶ –§–æ—Ä–º–∞—Ç –∑–∞–ø–∏—Å–∏

–ö–∞–∂–¥—ã–π —Ñ–∞–π–ª `<path>.enc` —Å–æ–¥–µ—Ä–∂–∏—Ç:

```json
{
  "version": 1,
  "nonce": "<base64>",
  "ciphertext": "<base64>"
}
```

–®–∏—Ñ—Ä—É–µ—Ç—Å—è JSON-—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ `Entry`.

---

## –ó–∞—á–µ–º —ç—Ç–æ –Ω—É–∂–Ω–æ

| –ü—Ä–æ–±–ª–µ–º–∞                  | –†–µ—à–µ–Ω–∏–µ –≤ pm                              |
| ------------------------- | ----------------------------------------- |
| pass —Å–ª–æ–∂–Ω–æ –±—ç–∫–∞–ø–∏—Ç—å      | ‚úÖ `backup create` –≤ ZIP/TAR.GZ            |
| —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–π –∑–æ–æ–ø–∞—Ä–∫   | ‚úÖ —Å–∞–º—ã–π –º–∏–Ω–∏–º–∞–ª–∏–∑–º, –º–∞–∫—Å–∏–º—É–º –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ |
| —Ö–æ—á–µ—Ç—Å—è OTP –≤ —Ç–æ–π –∂–µ –±–∞–∑–µ | ‚úÖ OTP –ø–æ–ª–µ –∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞                  |

